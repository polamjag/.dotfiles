#!/bin/sh

if ! hash sshfs &>/dev/null ; then
  echo "sshfs(1) may not be installed !"
  echo "abort"
  exit 1
fi

if [ $# -lt 1 ] ; then
  echo "missing argument(s): $0 [user@]host:[src] [sshfs options]"
  echo "run \`sshfs -h\` to show sshfs options"
  exit 1
fi

hostdir=$(echo "$1" | sed -e 's/\([a-zA-Z0-9_-]*@\)\?\([a-zA-Z0-9_.-]*\):.*/\2/g')

mntpoint="$HOME/mnt/$hostdir"
if [ ! -d "$mntpoint" ] ; then
  mkdir -p "$mntpoint"
fi

dsthost="$1"
shift

sshfs "$dsthost" "$mntpoint" "$@"

echo "mounted on $mntpoint"
