#!/bin/sh

# thanks: https://gist.github.com/willurd/5720255

port=8888

if [ "$1" != '' ] ; then
  port=$1
fi

echo "trying to serve on http://localhost:$port/ ..."

if hash python &>/dev/null ; then
  if [ $(python --version | sed -e "s/[A-Za-z]* *\([0-9]\).*/\1/g") = '3' ] ; then
    # python 3
    echo "exec: \`python -m http.server $port\` (expecting python3)"
    python -m http.server $port
  elif [ $(python --version | sed -e "s/[A-Za-z]* *\([0-9]\).*/\1/g") = '2' ] ; then
    # python 2
    echo "exec: \`python -m SimpleHTTPServer $port\` (expecting python2)"
    python -m SimpleHTTPServer $port
  fi
elif hash ruby &>/dev/null ; then
  echo "exec: \`ruby -rwebrick -e \"WEBrick::HTTPServer.new(:Port => $port, :DocumentRoot => Dir.pwd).start\"\`"
  ruby -rwebrick -e "WEBrick::HTTPServer.new(:Port => $port, :DocumentRoot => Dir.pwd).start"
elif hash php &>/dev/null ; then
  echo "exec: \`php -S localhost:$port\`"
  php -S localhost:$port
else
  echo "there are no commands to launch HTTP server!"
  exit 1
fi

