#!/bin/sh

if [ $# -ne 1 ] ; then
  echo "usage: $0 [FILENAME]"
  exit 1
fi

echo "Procecing $1 ..."

filepath=$(dirname "$1")
original_filename=$(basename $1)
filename="fhd_$original_filename"

convert "$filepath/$original_filename" -resize 1920x1080\! "$filepath/$filename"

if hash pngquant ; then
  pngquant "$filepath/$filename" --output "$filepath/optimized_$filename"
  mv "$filepath/optimized_$filename" "$filepath/$original_filename"
  rm "$filepath/fhd_$original_filename"
else
  mv "$filepath/$filename" "$filepath/$original_filename"
fi
